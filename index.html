<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ï£ºÍ∞Ñ Î£®Ìã¥ Í¥ÄÎ¶¨</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; padding: 0; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Lucide ÏïÑÏù¥ÏΩò SVG Ïª¥Ìè¨ÎÑåÌä∏
        const Check = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
        );
        
        const ChevronLeft = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
        );
        
        const ChevronRight = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
        );
        
        const RotateCcw = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="1 4 1 10 7 10"></polyline>
                <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
            </svg>
        );
        
        const Download = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
        );
        
        const Upload = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="17 8 12 3 7 8"></polyline>
                <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
        );

        function RoutineTracker() {
            const getCurrentWeek = () => {
                const now = new Date();
                const start = new Date(now.getFullYear(), 0, 1);
                const diff = now - start;
                const oneWeek = 1000 * 60 * 60 * 24 * 7;
                return Math.ceil(diff / oneWeek);
            };

            const [currentWeek, setCurrentWeek] = useState(getCurrentWeek());
            const [routines, setRoutines] = useState({
                sleep: Array(7).fill(false),
                reading: Array(7).fill(false),
                exercise: Array(3).fill(false),
                stairs: Array(2).fill(false),
                coffee: { success: false, fail: false },
                english: Array(3).fill(false),
                aiSummary: false,
                aiQuestion: false,
                childTalk: false,
                energyMoment: '',
                keepNext: '',
                weight: ''
            });

            useEffect(() => {
                const saved = localStorage.getItem(`routine:${currentWeek}`);
                if (saved) {
                    setRoutines(JSON.parse(saved));
                } else {
                    setRoutines({
                        sleep: Array(7).fill(false),
                        reading: Array(7).fill(false),
                        exercise: Array(3).fill(false),
                        stairs: Array(2).fill(false),
                        coffee: { success: false, fail: false },
                        english: Array(3).fill(false),
                        aiSummary: false,
                        aiQuestion: false,
                        childTalk: false,
                        energyMoment: '',
                        keepNext: '',
                        weight: ''
                    });
                }
            }, [currentWeek]);

            const saveData = (newRoutines) => {
                localStorage.setItem(`routine:${currentWeek}`, JSON.stringify(newRoutines));
            };

            const toggleCheck = (category, index = null) => {
                const newRoutines = { ...routines };
                
                if (Array.isArray(newRoutines[category])) {
                    newRoutines[category][index] = !newRoutines[category][index];
                } else if (category === 'coffee') {
                    if (index === 'success') {
                        newRoutines.coffee.success = !newRoutines.coffee.success;
                        if (newRoutines.coffee.success) newRoutines.coffee.fail = false;
                    } else {
                        newRoutines.coffee.fail = !newRoutines.coffee.fail;
                        if (newRoutines.coffee.fail) newRoutines.coffee.success = false;
                    }
                } else {
                    newRoutines[category] = !newRoutines[category];
                }
                
                setRoutines(newRoutines);
                saveData(newRoutines);
            };

            const updateText = (field, value) => {
                const newRoutines = { ...routines, [field]: value };
                setRoutines(newRoutines);
                saveData(newRoutines);
            };

            const resetWeek = () => {
                if (confirm('Ïù¥Î≤à Ï£º Îç∞Ïù¥ÌÑ∞Î•º Ï¥àÍ∏∞ÌôîÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                    const newRoutines = {
                        sleep: Array(7).fill(false),
                        reading: Array(7).fill(false),
                        exercise: Array(3).fill(false),
                        stairs: Array(2).fill(false),
                        coffee: { success: false, fail: false },
                        english: Array(3).fill(false),
                        aiSummary: false,
                        aiQuestion: false,
                        childTalk: false,
                        energyMoment: '',
                        keepNext: '',
                        weight: ''
                    };
                    setRoutines(newRoutines);
                    saveData(newRoutines);
                }
            };

            const downloadAllData = () => {
                const allData = {};
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key.startsWith('routine:')) {
                        allData[key] = JSON.parse(localStorage.getItem(key));
                    }
                }
                
                const dataStr = JSON.stringify(allData, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `routine-backup-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                alert('Î™®Îì† Îç∞Ïù¥ÌÑ∞Í∞Ä Îã§Ïö¥Î°úÎìúÎêòÏóàÏäµÎãàÎã§!');
            };

            const downloadCurrentWeek = () => {
                const dataStr = JSON.stringify({ [`routine:${currentWeek}`]: routines }, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `routine-week-${currentWeek}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            };

            const downloadAsCSV = () => {
                let csv = 'Week,Sleep,Reading,Exercise,Stairs,Coffee,English,AI Summary,AI Question,Child Talk,Energy Moment,Keep Next,Weight\n';
                
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key.startsWith('routine:')) {
                        const data = JSON.parse(localStorage.getItem(key));
                        const week = key.split(':')[1];
                        const sleepCount = data.sleep.filter(Boolean).length;
                        const readingCount = data.reading.filter(Boolean).length;
                        const exerciseCount = data.exercise.filter(Boolean).length;
                        const stairsCount = data.stairs.filter(Boolean).length;
                        const coffee = data.coffee.success ? 'Success' : data.coffee.fail ? 'Fail' : 'None';
                        const englishCount = data.english.filter(Boolean).length;
                        
                        csv += `${week},${sleepCount}/7,${readingCount}/7,${exerciseCount}/3,${stairsCount}/2,${coffee},${englishCount}/3,${data.aiSummary ? 'Y' : 'N'},${data.aiQuestion ? 'Y' : 'N'},${data.childTalk ? 'Y' : 'N'},"${data.energyMoment}","${data.keepNext}","${data.weight}"\n`;
                    }
                }
                
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `routine-data-${new Date().toISOString().split('T')[0]}.csv`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                alert('CSV ÌååÏùºÏù¥ Îã§Ïö¥Î°úÎìúÎêòÏóàÏäµÎãàÎã§!');
            };

            const restoreData = (event) => {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = JSON.parse(e.target.result);
                        
                        for (const [key, value] of Object.entries(data)) {
                            localStorage.setItem(key, JSON.stringify(value));
                        }
                        
                        const saved = localStorage.getItem(`routine:${currentWeek}`);
                        if (saved) {
                            setRoutines(JSON.parse(saved));
                        }
                        
                        alert('Îç∞Ïù¥ÌÑ∞Í∞Ä Î≥µÏõêÎêòÏóàÏäµÎãàÎã§!');
                    } catch (error) {
                        console.error('Î≥µÏõê Ïã§Ìå®:', error);
                        alert('ÌååÏùº ÌòïÏãùÏù¥ Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏäµÎãàÎã§.');
                    }
                };
                reader.readAsText(file);
            };

            const days = ['Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†', 'Ïùº'];

            const CheckBox = ({ checked, onClick }) => (
                <button
                    onClick={onClick}
                    className={`w-8 h-8 border-2 rounded flex items-center justify-center transition-all ${
                        checked 
                            ? 'bg-blue-500 border-blue-500 text-white' 
                            : 'border-gray-300 hover:border-blue-400'
                    }`}
                >
                    {checked && <Check size={18} />}
                </button>
            );

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4 md:p-8">
                    <div className="max-w-3xl mx-auto bg-white rounded-2xl shadow-xl p-6 md:p-8">
                        <div className="flex items-center justify-between mb-8">
                            <button
                                onClick={() => setCurrentWeek(currentWeek - 1)}
                                className="p-2 hover:bg-gray-100 rounded-full transition-colors"
                            >
                                <ChevronLeft size={24} />
                            </button>
                            
                            <h1 className="text-2xl md:text-3xl font-bold text-gray-800">
                                2026 Week {currentWeek}
                            </h1>
                            
                            <div className="flex gap-2">
                                <button
                                    onClick={resetWeek}
                                    className="p-2 hover:bg-gray-100 rounded-full transition-colors"
                                    title="Ï¥àÍ∏∞Ìôî"
                                >
                                    <RotateCcw size={20} />
                                </button>
                                <button
                                    onClick={() => setCurrentWeek(currentWeek + 1)}
                                    className="p-2 hover:bg-gray-100 rounded-full transition-colors"
                                >
                                    <ChevronRight size={24} />
                                </button>
                            </div>
                        </div>

                        <div className="mb-6 p-4 bg-blue-50 rounded-lg">
                            <h3 className="text-sm font-semibold text-gray-700 mb-3">üíæ Îç∞Ïù¥ÌÑ∞ Í¥ÄÎ¶¨</h3>
                            <div className="flex flex-wrap gap-2">
                                <button
                                    onClick={downloadCurrentWeek}
                                    className="flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm"
                                >
                                    <Download size={16} />
                                    ÌòÑÏû¨ Ï£ºÏ∞® Ï†ÄÏû•
                                </button>
                                <button
                                    onClick={downloadAllData}
                                    className="flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm"
                                >
                                    <Download size={16} />
                                    Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                                </button>
                                <button
                                    onClick={downloadAsCSV}
                                    className="flex items-center gap-2 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors text-sm"
                                >
                                    <Download size={16} />
                                    CSV Îã§Ïö¥Î°úÎìú
                                </button>
                                <label className="flex items-center gap-2 px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors cursor-pointer text-sm">
                                    <Upload size={16} />
                                    Îç∞Ïù¥ÌÑ∞ Î≥µÏõê
                                    <input
                                        type="file"
                                        accept=".json"
                                        onChange={restoreData}
                                        className="hidden"
                                    />
                                </label>
                            </div>
                        </div>

                        <div className="space-y-6">
                            <div className="border-b pb-4">
                                <h2 className="text-lg font-semibold mb-3 flex items-center gap-2">
                                    üõå ÏàòÎ©¥ (12Ïãú Ïù¥Ï†Ñ)
                                </h2>
                                <div className="flex gap-2 flex-wrap">
                                    {days.map((day, i) => (
                                        <div key={i} className="flex flex-col items-center gap-1">
                                            <span className="text-sm text-gray-600">{day}</span>
                                            <CheckBox 
                                                checked={routines.sleep[i]} 
                                                onClick={() => toggleCheck('sleep', i)} 
                                            />
                                        </div>
                                    ))}
                                </div>
                            </div>

                            <div className="border-b pb-4">
                                <h2 className="text-lg font-semibold mb-3 flex items-center gap-2">
                                    üìö 10Î∂Ñ ÎèÖÏÑú
                                </h2>
                                <div className="flex gap-2 flex-wrap">
                                    {days.map((day, i) => (
                                        <div key={i} className="flex flex-col items-center gap-1">
                                            <span className="text-sm text-gray-600">{day}</span>
                                            <CheckBox 
                                                checked={routines.reading[i]} 
                                                onClick={() => toggleCheck('reading', i)} 
                                            />
                                        </div>
                                    ))}
                                </div>
                            </div>

                            <div className="border-b pb-4">
                                <h2 className="text-lg font-semibold mb-3">üèÉ Ïö¥Îèô (Ï£º 3Ìöå)</h2>
                                <div className="flex gap-2">
                                    {[1, 2, 3].map((num, i) => (
                                        <CheckBox 
                                            key={i}
                                            checked={routines.exercise[i]} 
                                            onClick={() => toggleCheck('exercise', i)} 
                                        />
                                    ))}
                                </div>
                            </div>

                            <div className="border-b pb-4">
                                <h2 className="text-lg font-semibold mb-3">üè¢ Í≥ÑÎã® (Ï£º 2Ìöå)</h2>
                                <div className="flex gap-2">
                                    {[1, 2].map((num, i) => (
                                        <CheckBox 
                                            key={i}
                                            checked={routines.stairs[i]} 
                                            onClick={() => toggleCheck('stairs', i)} 
                                        />
                                    ))}
                                </div>
                            </div>

                            <div className="border-b pb-4">
                                <h2 className="text-lg font-semibold mb-3">‚òï Ïª§Ìîº Ïã§Ìóò</h2>
                                <div className="flex gap-4">
                                    <label className="flex items-center gap-2 cursor-pointer">
                                        <CheckBox 
                                            checked={routines.coffee.success} 
                                            onClick={() => toggleCheck('coffee', 'success')} 
                                        />
                                        <span>ÏÑ±Í≥µ</span>
                                    </label>
                                    <label className="flex items-center gap-2 cursor-pointer">
                                        <CheckBox 
                                            checked={routines.coffee.fail} 
                                            onClick={() => toggleCheck('coffee', 'fail')} 
                                        />
                                        <span>Ïã§Ìå®</span>
                                    </label>
                                </div>
                            </div>

                            <div className="border-b pb-4">
                                <h2 className="text-lg font-semibold mb-3">üó£Ô∏è ÏòÅÏñ¥ Ïä§ÌîºÌÇπ (Ï£º 3Ìöå)</h2>
                                <div className="flex gap-2">
                                    {[1, 2, 3].map((num, i) => (
                                        <CheckBox 
                                            key={i}
                                            checked={routines.english[i]} 
                                            onClick={() => toggleCheck('english', i)} 
                                        />
                                    ))}
                                </div>
                            </div>

                            <div className="border-b pb-4">
                                <h2 className="text-lg font-semibold mb-3">ü§ñ AI ÌôúÏö©</h2>
                                <div className="space-y-2">
                                    <label className="flex items-center gap-2 cursor-pointer">
                                        <CheckBox 
                                            checked={routines.aiSummary} 
                                            onClick={() => toggleCheck('aiSummary')} 
                                        />
                                        <span>Ïò§Îäò ÏöîÏïΩ</span>
                                    </label>
                                    <label className="flex items-center gap-2 cursor-pointer">
                                        <CheckBox 
                                            checked={routines.aiQuestion} 
                                            onClick={() => toggleCheck('aiQuestion')} 
                                        />
                                        <span>ÏÉùÍ∞Å ÏßàÎ¨∏ 1Í∞ú</span>
                                    </label>
                                </div>
                            </div>

                            <div className="border-b pb-4">
                                <h2 className="text-lg font-semibold mb-3">üë¶ ÏïÑÏù¥ ÏßëÏ§ë ÎåÄÌôî</h2>
                                <label className="flex items-center gap-2 cursor-pointer">
                                    <CheckBox 
                                        checked={routines.childTalk} 
                                        onClick={() => toggleCheck('childTalk')} 
                                    />
                                    <span>ÏôÑÎ£å</span>
                                </label>
                            </div>

                            <div className="border-b pb-4">
                                <h2 className="text-lg font-semibold mb-3">üß† ÎÇò ÌÉêÍµ¨</h2>
                                <div className="space-y-3">
                                    <div>
                                        <label className="block text-sm text-gray-600 mb-1">
                                            Ïù¥Î≤à Ï£º ÏóêÎÑàÏßÄ ÏÉÅÏäπ ÏàúÍ∞Ñ:
                                        </label>
                                        <textarea
                                            value={routines.energyMoment}
                                            onChange={(e) => updateText('energyMoment', e.target.value)}
                                            className="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none"
                                            rows="2"
                                            placeholder="ÏóêÎÑàÏßÄÍ∞Ä Ïò¨ÎùºÍ∞îÎçò ÏàúÍ∞ÑÏùÑ Í∏∞Î°ùÌïòÏÑ∏Ïöî..."
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm text-gray-600 mb-1">
                                            Îã§Ïùå Ï£º Ïú†ÏßÄÌï† Í≤É 1Í∞ÄÏßÄ:
                                        </label>
                                        <textarea
                                            value={routines.keepNext}
                                            onChange={(e) => updateText('keepNext', e.target.value)}
                                            className="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none"
                                            rows="2"
                                            placeholder="Îã§Ïùå Ï£ºÏóêÎèÑ Í≥ÑÏÜçÌï† Í≤ÉÏùÑ Ï†ÅÏñ¥Î≥¥ÏÑ∏Ïöî..."
                                        />
                                    </div>
                                </div>
                            </div>

                            <div>
                                <h2 className="text-lg font-semibold mb-3">üìâ Ï≤¥Ï§ë Í∏∞Î°ù</h2>
                                <div>
                                    <label className="block text-sm text-gray-600 mb-1">
                                        Ïù¥Î≤à Ï£º:
                                    </label>
                                    <input
                                        type="text"
                                        value={routines.weight}
                                        onChange={(e) => updateText('weight', e.target.value)}
                                        className="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none"
                                        placeholder="Ïòà: 70kg"
                                    />
                                </div>
                            </div>
                        </div>

                        <div className="mt-8 text-center text-sm text-gray-500">
                            Îç∞Ïù¥ÌÑ∞Îäî ÏûêÎèôÏúºÎ°ú Ï†ÄÏû•Îê©ÎãàÎã§
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<RoutineTracker />, document.getElementById('root'));
    </script>
</body>
</html>
